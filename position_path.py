import pyodrivecan
import asyncio
from datetime import datetime, timedelta


nodeID_1_pos = [-0.0679353722371161, -0.022727176547050476, 0.011717163026332855, 0.046161502599716187, 0.08060584217309952, 0.11505018174648285, 0.14776278554927558, 0.17206410132348537, 0.1849854391766712, 0.1894954890012741, 0.1922738030552864, 0.1950521171092987, 0.197830431163311, 0.2006087452173233, 0.20327690214617178, 0.2054100101813674, 0.20681922853691503, 0.20769339799880981, 0.20845741033554077, 0.20922142267227173, 0.20998543500900269, 0.21074944734573364, 0.21147540351375937, 0.2120165154337883, 0.2123075439594686, 0.2124137282371521, 0.21248185634613037, 0.21254998445510864, 0.21261811256408691, 0.21268624067306519, 0.21275317983236164, 0.21281434409320354, 0.21286769525613636, 0.21291527152061462, 0.21296165883541107, 0.21300804615020752, 0.21305443346500397, 0.21310082077980042, 0.2131455167545937, 0.21318199764937162, 0.21320736402412876, 0.21322451531887054, 0.21323997527360916, 0.21325543522834778, 0.2132708951830864, 0.213286355137825, 0.2133019026950933, 0.21331787575036287, 0.21333442447939888, 0.21335139870643616, 0.2133684605360031, 0.21338552236557007, 0.21340258419513702, 0.21341964602470398, 0.2134405371034518, 0.2134800273925066, 0.2135446813190356, 0.21362793445587158, 0.21371501684188843, 0.21380209922790527, 0.21388918161392212, 0.21397626399993896, 0.21407401270698756, 0.2142235692590475, 0.21444321877788752, 0.2147146761417389, 0.214996799826622, 0.21527892351150513, 0.21556104719638824, 0.21584317088127136, 0.2161136352806352, 0.21632746886461973, 0.21646468428662047, 0.21654526889324188, 0.21661419421434402, 0.21668311953544617, 0.2167520448565483, 0.21682097017765045, 0.21688674221513793, 0.2169371983036399, 0.21696693281410262, 0.21698135137557983, 0.21699261665344238, 0.21700388193130493, 0.21701514720916748, 0.21702641248703003, 0.21703657152829692, 0.21704135742038488, 0.21703887375770137, 0.21703101694583893, 0.21702205389738083, 0.21701309084892273, 0.21700412780046463, 0.21699516475200653, 0.2169602387584746, 0.21679920703172684, 0.2164675616659224, 0.21600981056690216, 0.21552609652280807, 0.215042382478714, 0.2145586684346199, 0.21407495439052582, 0.2132081088493578, 0.21048033889383078, 0.205234847671818, 0.19812843203544617, 0.19063888490200043, 0.1831493377685547, 0.17565979063510895, 0.1681702435016632, 0.16015768115175888, 0.1496047591790557, 0.13561488006962463, 0.11908464133739471, 0.10203138738870621, 0.0849781334400177, 0.0679248794913292, 0.050871625542640686, 0.03371482316288166, 0.016055071260780096, -0.002285141759784892, -0.021128304302692413, -0.040075015276670456, -0.0590217262506485, -0.07796843722462654, -0.09691514819860458, -0.11600042661302723, -0.13575874688103795, -0.15642765318625607, -0.17776960134506226, -0.19925011694431305, -0.22073063254356384, -0.24221114814281464, -0.26369166374206543, -0.28482234678813256, -0.30425384314730763, -0.3213864398712758, -0.3368198499083519, -0.35190342739224434, -0.3669870048761368, -0.3820705823600292, -0.39715415984392166, -0.4127296192164067, -0.43069421919062734, -0.4518911858613137, -0.47547729313373566, -0.4995552822947502, -0.5236332714557648, -0.5477112606167793, -0.5717892497777939, -0.5958652122644708, -0.6199313309043646, -0.6439841313986108, -0.6680270880460739, -0.6920680180191994, -0.7161089479923248, -0.7401498779654503, -0.7641908079385757, -0.7895369304460473, -0.8212225595489144, -0.861485168163199, -0.908087283372879, -0.9559945911169052, -1.0039018988609314, -1.0518092066049576, -1.0997165143489838, -1.1471715493826196, -1.192429831251502, -1.2347160353092477, -1.27480548620224, -1.314442664384842, -1.3540798425674438, -1.3937170207500458, -1.4333541989326477, -1.4721290373709053, -1.5067153684794903, -1.5356348955538124, -1.560365915298462, -1.584234595298767, -1.6081032752990723, -1.6319719552993774, -1.6558406352996826, -1.679727181326598, -1.7037005051970482, -1.7277912343852222, -1.7519687414169312, -1.7761641144752502, -1.8003594875335693, -1.8245548605918884, -1.8487502336502075, -1.8728715837933123, -1.896633394062519, -1.9199087680317461, -1.9428246021270752, -1.96566641330719, -1.9885082244873047, -2.0113500356674194, -2.034191846847534, -2.05626836232841, -2.0746277272701263, -2.0879580061882734, -2.0975711345672607, -2.1064189672470093, -2.115266799926758, -2.1241146326065063, -2.132962465286255, -2.1414023651741445, -2.1478608772158623, -2.1516386880539358, -2.1534351110458374, -2.15482360124588, -2.156212091445923, -2.1576005816459656, -2.1589890718460083, -2.1603197508957237, -2.1613696329295635, -2.162039613118395, -2.1624287962913513, -2.16276016831398, -2.163091540336609, -2.1634229123592377, -2.1637542843818665, -2.1641768428962678, -2.16504230722785, -2.1665069970767945, -2.16841459274292, -2.170413374900818, -2.172412157058716, -2.1744109392166138, -2.1764097213745117, -2.1783802832942456, -2.180213775485754, -2.1818618203978986, -2.1833727955818176, -2.1848555505275726, -2.1863383054733276, -2.1878210604190826, -2.1893038153648376, -2.1907447655685246, -2.191982664167881, -2.1929458458907902, -2.193705976009369, -2.1944243013858795, -2.19514262676239, -2.1958609521389008, -2.1965792775154114, -2.1972555064130574, -2.1977272666990757, -2.197922392981127, -2.1979130506515503, -2.197861611843109, -2.197810173034668, -2.197758734226227, -2.1977072954177856, -2.1977253681980073, -2.1980810686945915, -2.1988935596309602, -2.2000436782836914, -2.2012633085250854, -2.2024829387664795, -2.2037025690078735, -2.2049221992492676, -2.2060867727268487, -2.2069839276373386, -2.207519280957058, -2.2077872157096863, -2.2080000936985016, -2.208212971687317, -2.208425849676132, -2.2086387276649475, -2.208703981945291, -2.2080522067844868, -2.2064303329680115, -2.204091429710388, -2.201604902744293, -2.1991183757781982, -2.1966318488121033, -2.1941453218460083, -2.191295681986958, -2.186682350933552, -2.1796828494407237, -2.17091965675354, -2.161793351173401, -2.1526670455932617, -2.1435407400131226, -2.1344144344329834, -2.124775200150907, -2.112644597887993, -2.097143321298063, -2.079150676727295, -2.06064510345459, -2.0421395301818848, -2.0236339569091797, -2.0051283836364746, -1.986862133955583, -1.9697583131492138, -1.9542271902319044, -1.9398584961891174, -1.925729125738144, -1.9115997552871704, -1.897470384836197, -1.8833410143852234, -1.8696711848024279, -1.8582334108650684, -1.849815476918593, -1.8436295986175537, -1.8379032611846924, -1.832176923751831, -1.8264505863189697, -1.8207242488861084, -1.814967573271133, -1.8090635407716036, -1.8029601430753246, -1.7967093884944916, -1.7904282957315445, -1.7841472029685974, -1.7778661102056503, -1.7715850174427032, -1.7651581858517602, -1.7580234799534082, -1.7499310617567971, -1.741130769252777, -1.732184737920761, -1.7232387065887451, -1.7142926752567291, -1.7053466439247131, -1.6953303614864126, -1.6801157165318727, -1.6578679928788915, -1.630421906709671, -1.601905569434166, -1.5733892321586609, -1.5448728948831558, -1.5163565576076508, -1.4891214305534959, -1.4681093245744705, -1.4555166000500321, -1.4491468966007233, -1.4440584033727646, -1.438969910144806, -1.4338814169168472, -1.4287929236888885, -1.4239586089970544, -1.4203588757663965, -1.4184294586302713, -1.4177346229553223, -1.4172939658164978, -1.4168533086776733, -1.4164126515388489, -1.4159719944000244, 
-1.4155319737037644, -1.4150950442999601, -1.4146622972330078, -1.4142326414585114, -1.4138036221265793, -1.4133746027946472, -1.4129455834627151, -1.412516564130783, -1.4120882007991895, -1.4116630237549543, -1.4112421575700864, -1.410824477672577, -1.4104074537754059, -1.4099904298782349, -1.4095734059810638, -1.4091563820838928, -1.4087428720667958, -1.4083464294672012, -1.4079730780795217, -1.4076167941093445, -1.4072640240192413, -1.4069112539291382, -1.406558483839035, -1.4062057137489319, -1.4058628390775993, -1.405568027868867, -1.40533824369777, -1.405156522989273, -1.4049846976995468, -1.4048128724098206, -1.4046410471200943, -1.404469221830368, -1.4042979172663763, -1.4041291419416666, -1.4039637885289267, -1.4038009643554688, -1.4036386609077454, -1.403476357460022, -1.4033140540122986, -1.4031517505645752, -1.4029853725805879, -1.40279920399189, -1.4025862598791718, -1.4023535251617432, -1.4021167159080505, -1.401879906654358, -1.4016430974006653, -1.4014062881469727, -1.4011760853463784, -1.4009779710322618, -1.4008232705527917, -1.4007006585597992, -1.400584653019905, -1.400468647480011, -1.4003526419401169, -1.4002366364002228, -1.4001215297030285, -1.4000107888132334, -1.399905954604037, -1.39980548620224, -1.3997059166431427, -1.3996063470840454, -1.3995067775249481, -1.3994072079658508, -1.3993095778860152, -1.3992213681340218, -1.399145903531462, -1.3990798592567444, -1.3990157544612885, -1.3989516496658325, -1.3988875448703766, -1.3988234400749207, -1.3987596433144063, 
-1.398697342723608, -1.3986370663624257, -1.3985782861709595, -1.3985198140144348, -1.3984613418579102, -1.3984028697013855, -1.3983443975448608, -1.3982874215580523, -1.3982377126812935, -1.398197835776955, -1.398165225982666, -1.3981341123580933, -1.3981029987335205, -1.3980718851089478, -1.398040771484375, -1.3980089391116053, -1.3979736156761646, -1.3979335690382868, -1.397890031337738, -1.3978457748889923, -1.3978015184402466, -1.3977572619915009, -1.3977130055427551, -1.3976697139441967, -1.3976311087608337, -1.3975988440215588, -1.3975712656974792, -1.397544652223587, -1.3975180387496948, -1.3974914252758026, -1.3974648118019104, -1.39743860415183, -1.397414367645979, -1.3973927979823202, -1.3973731994628906, -1.397354006767273, -1.3973348140716553, -1.3973156213760376, -1.39729642868042, -1.3972771797562018, -1.3972576577216387, -1.397237766184844, -1.3972176015377045, -1.3971973806619644, -1.3971771597862244, -1.3971569389104843, -1.3971367180347443, -1.3971167530398816, -1.3970980308949947, -1.3970809902530164, -1.3970651924610138, -1.3970496505498886, -1.3970341086387634, -1.3970185667276382, -1.397003024816513, -1.3969863493693992, -1.396964168176055, -1.3969345380319282, -1.396899402141571, -1.3968631327152252, -1.3968268632888794, -1.3967905938625336, -1.3967543244361877, -1.396718935109675, -1.3966878205537796, -1.3966624895110726, -1.3966414332389832, -1.3966212570667267, -1.3966010808944702, -1.3965809047222137, -1.3965607285499573, -1.3965409834636375, -1.3965233322232962, -1.3965085138333961, -1.3964957892894745, -1.3964834958314896, -1.3964712023735046, -1.3964589089155197, -1.3964466154575348, -1.3964332634350285, -1.3964147698134184, -1.3963893199106678, -1.3963587284088135, -1.3963270783424377, -1.396295428276062, -1.3962637782096863, -1.3962321281433105, -1.3962012123083696, -1.3961738627403975, -1.3961513381218538, -1.396132379770279, -1.3961141556501389, -1.3960959315299988, -1.3960777074098587, -1.3960594832897186, -1.395949102123268, -1.3953911010175943, -1.3942274964647368, -1.3926162719726562, -1.3909128904342651, -1.389209508895874, -1.387506127357483, -1.3858027458190918, -1.3834202882135287, -1.3777394611388445, -1.367596134194173, -1.3541544377803802, -1.3400336652994156, -1.325912892818451, -1.3117921203374863, -1.2976713478565216, -1.2810646103462204, -1.2523831855505705, -1.2073654191335663, -1.1502729654312134, -1.090694546699524, -1.0311161279678345, -0.971537709236145, -0.9119592905044556, -0.8482672464451753, -0.7645947365090251, -0.6538898315629922, -0.5232044607400894, -0.3884054645895958, -0.2536064684391022, -0.11880747228860855, 0.01599152386188507, 0.14530178147833794, 0.24795245192945004, 0.3145342691568658, 0.35445649921894073, 0.38888999074697495, 0.42332348227500916, 0.45775697380304337, 0.4921904653310776, 0.5248027654597536, 0.5485692787915468, 0.5603679629275575, 0.5633208602666855, 0.5644525662064552, 0.565584272146225, 0.5667159780859947, 0.5678476840257645, 0.5684177874645684, 0.5662601073272526, 0.5604118964693043, 0.5518359020352364, 0.5426983051002026, 0.5335607081651688, 0.524423111230135, 0.5152855142951012, 0.5053228392498568, 0.49135264195501804, 0.4719605027930811, 0.44856084138154984, 0.42433610185980797, 0.4001113623380661, 0.37588662281632423, 0.35166188329458237, 0.3273241342685651, 0.30243748193606734, 0.27680819571833126, 0.2506300061941147, 0.2243388071656227, 0.19804760813713074, 0.17175640910863876, 0.1454652100801468, 0.11920112260850146, 0.09306871984153986, 0.06711447873385623, 0.04129192233085632, 0.015496477484703064, -0.010298967361450195, -0.036094412207603455, -0.061889857053756714, -0.08759346144506708, -0.11285098362714052, -0.13750498282024637, -0.1617128998041153, -0.18582897633314133, -0.20994505286216736, -0.2340611293911934, -0.2581772059202194, -0.28192643442889675, -0.3038938296958804, -0.32345050940057263, -0.34122535586357117, -0.358633354306221, -0.37604135274887085, -0.3934493511915207, -0.41085734963417053, -0.42850239807739854, -0.4472988322377205, -0.46765302354469895, -0.48915860056877136, -0.5109012275934219, -0.5326438546180725, -0.5543864816427231, -0.5761291086673737, -0.5977103404584341, -0.6185076525434852, -0.6382443673792295, -0.6571971625089645, -0.6759885624051094, -0.6947799623012543, -0.7135713621973991, -0.732362762093544, -0.7523598775733262, -0.7782133258879185, -0.8119900480378419, -0.8516231030225754, -0.8924618735909462, -0.933300644159317, -0.9741394147276878, -1.0149781852960587, -1.055000480322633, -1.0910570370033383, -1.1217481829808094, -1.1484735906124115, -1.174382522702217, -1.2002914547920227, -1.2262003868818283, -1.252109318971634, -1.2774746573995799, -1.3001996837556362, -1.3193525231909007, -1.3358650505542755, -1.3518339842557907, -1.367802917957306, -1.383771851658821, -1.3997407853603363, -1.415994380833581, -1.4336306191980839, -1.453137492062524, -1.474027007818222, -1.4952011853456497, -1.5163753628730774, -1.537549540400505, -1.5587237179279327, -1.5790410881163552, -1.5951968226581812, -1.6057221089722589, -1.61208575963974, -1.617592602968216, -1.623099446296692, -1.6286062896251678, -1.6341131329536438, -1.6393586257472634, -1.6433347016572952, -1.645593331195414, -1.646582543849945, -1.6473104059696198, -1.6480382680892944, -1.6487661302089691, -1.6494939923286438, -1.6501860115677118, -1.6507039368152618, -1.650986323133111, -1.6510946154594421, -1.6511670649051666, -1.6512395143508911, -1.6513119637966156, -1.65138441324234, -1.651451390585862, -1.6514917891472578, -1.6514962281798944, -1.6514740884304047, -1.6514464765787125, -1.6514188647270203, -1.651391252875328, -1.6513636410236359, -1.6513331957394257, -1.6512889880686998, -1.6512261606985703, -1.651149570941925, -1.6510701477527618, -1.6509907245635986, -1.6509113013744354, -1.6508318781852722, -1.650745978928171, -1.650628624483943, -1.6504687130218372, -1.6502773463726044, -1.6500795036554337, -1.649881660938263, -1.6496838182210922, -1.6494859755039215, -1.6492557141464204, -1.6488679908216, -1.6482672307174653, -1.6475090086460114, -1.646718367934227, -1.6459277272224426, -1.6451370865106583, -1.644346445798874, -1.6435791603289545, -1.642925314605236, -1.6424249461852014, -1.6420380175113678, -1.641674444079399, -1.6413108706474304, -1.6409472972154617, -1.640583723783493, -1.6401668513426557, -1.6394910980015993, -1.6384650940308347, -1.637180209159851, -1.6358420252799988, -1.6345038414001465, -1.6331656575202942, -1.631827473640442, -1.6302652733866125, -1.6276149936020374, -1.6234926062170416, -1.6182821393013, -1.6128476560115814, -1.6074131727218628, -1.6019786894321442, -1.5965442061424255, -1.5911722889868543, -1.5861042644828558, -1.581447388860397, -1.577094405889511, -1.5728039890527725, -1.568513572216034, -1.5642231553792953, -1.5599327385425568, -1.5558326164027676, -1.5526567827910185, -1.5507314571877941, -1.5497304201126099, -1.548919677734375, -1.5481089353561401, -1.5472981929779053, -1.5464874505996704, -1.5456986414501444, -1.5450163651257753, -1.544478221447207, -1.5440466105937958, -1.5436369329690933, -1.5432272553443909, -1.5428175777196884, -1.542407900094986, -1.5420147267868742, -1.5417017173022032, -1.5414971647551283, -1.5413727760314941, -1.5412648916244507, -1.5411570072174072, -1.5410491228103638, 
-1.5409412384033203, -1.5408336840337142, -1.5407277327030897, -1.5406239501899108, -1.5405217707157135, -1.5404199212789536, -1.5403180718421936, -1.5402162224054337, -1.5401143729686737, -1.540014871279709, -1.5399267729371786, -1.5398541026515886, -1.5397928357124329, -1.5397339165210724, -1.539674997329712, -1.5396160781383514, -1.539557158946991, -1.5395002444274724, -1.5394530668854713, -1.5394190629012883, -1.5393947958946228, -1.5393725335597992, -1.5393502712249756, -1.539328008890152, -1.5393057465553284, -1.5392833929508924, -1.539260596036911, -1.5392371993511915, -1.5392133593559265, -1.5391894280910492, -1.5391654968261719, -1.5391415655612946, -1.5391176342964172, -1.539093496860005, -1.5390683580189943, -1.5390418643364683, -1.5390143692493439, -1.5389866679906845, -1.5389589667320251, -1.5389312654733658, -1.5389035642147064, -1.538875798578374, -1.5388477202504873, -1.538819218869321, -1.5387904047966003, -1.5387615263462067, -1.538732647895813, -1.5387037694454193, -1.5386748909950256, -1.5386460459558293, -1.5386173631995916, -1.538588900002651, -1.5385605990886688, -1.538532331585884, -1.5385040640830994, -1.5384757965803146, -1.53844752907753, -1.5384193398058414, -1.5383915305137634, -1.5383642353117466, -1.5383373200893402, -1.53831048309803, -1.53828364610672, -1.5382568091154099, -1.5382299721240997, -1.538204209995456, -1.538183668628335, -1.5381701906444505, -1.5381619334220886, -1.5381547510623932, -1.5381475687026978, -1.5381403863430023, -1.5381332039833069, -1.538124195416458, -1.5381063167005777, -1.5380764371948317, -1.5380376875400543, -1.5379971116781235, -1.5379565358161926, -1.5379159599542618, -1.537875384092331, -1.5378312242683023, -1.5377696566283703, -1.53768453723751, -1.5375820100307465, -1.537475898861885, -1.5373697876930237, -1.5372636765241623, -1.537157565355301, -1.537051429739222, -1.5369451753795147, -1.5368387603666633, -1.5367322266101837, -1.5366256684064865, -1.5365191102027893, -1.536412551999092, -1.536305993795395, -1.5361995178973302, -1.5360934417694807, -1.5359879065072164, -1.5358827710151672, -1.5357777178287506, -1.535672664642334, -1.5355676114559174, -1.5354625582695007, -1.5353625094285235, -1.5352867674082518, -1.5352439110865816, -1.535225361585617, -1.5352118164300919, -1.5351982712745667, -1.5351847261190414, -1.5351711809635162, -1.5351573440711945, -1.5351420901715755, -1.5351249191444367, -1.5351063311100006, -1.535087451338768, -1.5350685715675354, -1.5350496917963028, -1.5350308120250702, -1.535013190470636, -1.5350016802549362, -1.534998438321054, -1.5350013077259064, -1.535005435347557, -1.5350095629692078, -1.5350136905908585, -1.5350178182125092, -1.535021394956857, -1.535022296011448, -1.5350195770151913, -1.5350141823291779, -1.5350082367658615, -1.5350022912025452, -1.5349963456392288, -1.5349904000759125, -1.534985717618838, -1.5349871702492237, -1.5349969232920557, -1.535012811422348, -1.5350299626588821, -1.5350471138954163, -1.5350642651319504, -1.5350814163684845, -1.5350971618900076, -1.5351060796529055, -1.5351057598600164, -1.5350986123085022, -1.535090059041977, -1.5350815057754517, -1.5350729525089264, -1.5350643992424011, -1.53505715879146, -1.5350562948733568, -1.5350640580290928, -1.5350781977176666, -1.5350936502218246, -1.5351091027259827, -1.5351245552301407, -1.5351400077342987, -1.535154136014171, -1.5351618323475122, -1.535160826635547, -1.5351533889770508, -1.5351446270942688, -1.5351358652114868, -1.5351271033287048, -1.5351183414459229, -1.5351102290442213, -1.5351052712649107, -1.5351045815041289, -1.535107046365738, -1.5351101607084274, -1.535113275051117, -1.5351163893938065, -1.535119503736496, -1.5351224852493033, -1.535124821588397, -1.5351262850454077, -1.5351271033287048, -1.5351277887821198, -1.5351284742355347, -1.5351291596889496, -1.5351298451423645, -1.5351310602854937, -1.5351348482072353, -1.5351421169470996, -1.5351519584655762, -1.535162329673767, -1.535172700881958, -1.535183072090149, -1.5351934432983398, -1.5352033980889246, -1.535211330279708, -1.5352165260119364, -1.5352196991443634, -1.5352224558591843, -1.5352252125740051, -1.535227969288826, -1.5352307260036469, -1.5352325235726312, -1.5352296624332666, -1.5352204983355477, -1.53520667552948, -1.5351918935775757, -1.5351771116256714, -1.535162329673767, -1.5351475477218628, -1.535134537378326, -1.5351301319897175, -1.535137368598953, -1.5351532101631165, -1.5351708233356476, -1.5351884365081787, -1.5352060496807098, -1.535223662853241, -1.535246780142188, -1.5352588891983032]

nodeID_2_pos = [0.01521595986559987, 0.011347696185112, 0.00840044766664505, 0.005453199148178101, 0.002505950629711151, -0.00044129788875579834, -0.003104396804701537, -0.004387340508401394, -0.0038030153955332935, -0.0018385350704193115, 0.00041009485721588135, 0.0026587247848510742, 0.004907354712486267, 0.00715598464012146, 0.0092300622491166, 0.01045631431043148, 0.010535508277826011, 0.009766876697540283, 0.008823692798614502, 0.00788050889968872, 0.0069373250007629395, 0.005994141101837158, 0.005114109662827104, 0.004540818743407726, 0.004382529703434557, 0.004530981183052063, 0.004742585122585297, 0.00495418906211853, 0.005165793001651764, 0.0053773969411849976, 0.005569565750192851, 0.005667335353791714, 0.0056373883853666484, 0.005513042211532593, 0.005369260907173157, 0.005225479602813721, 0.005081698298454285, 0.004937916994094849, 0.004799811926204711, 0.004689277149736881, 0.004616043355781585, 0.004570379853248596, 0.004530392587184906, 0.004490405321121216, 0.004450418055057526, 0.0044104307889938354, 0.004373979405499995, 0.0043547023087739944, 0.004358661011792719, 0.004379794001579285, 0.0044044628739356995, 0.004429131746292114, 0.004453800618648529, 0.004478469491004944, 0.004499133909121156, 0.004500348120927811, 0.004475247347727418, 0.004430696368217468, 0.004382140934467316, 0.004333585500717163, 0.0042850300669670105, 0.004236474633216858, 0.004188454593531787, 0.004143035039305687, 0.00410113378893584, 0.004061833024024963, 0.004023067653179169, 0.003984302282333374, 0.003945536911487579, 0.003906771540641785, 0.0038671004003845155, 0.0038230298087000847, 0.0037730070180259645, 0.0037185847759246826, 0.0036632567644119263, 0.00360792875289917, 0.0035526007413864136, 0.0034972727298736572, 0.0034404232865199447, 0.003376184031367302, 0.0033019467955455184, 0.0032203197479248047, 0.0031371712684631348, 0.003054022789001465, 0.002970874309539795, 0.002887725830078125, 0.0028041694895364344, 0.002718632109463215, 0.002630414499435574, 0.002540215849876404, 0.002449609339237213, 0.0023590028285980225, 0.002268396317958832, 0.002177789807319641, 0.0020849761203862727, 0.0019814418628811836, 0.001863403304014355, 0.0017346441745758057, 0.0016036778688430786, 0.0014727115631103516, 0.0013417452573776245, 0.0012107789516448975, 0.0010832434054464102, 0.0009723715484142303, 0.0008840446826070547, 0.0008123815059661865, 0.0007441490888595581, 0.0006759166717529297, 0.0006076842546463013, 0.0005394518375396729, 0.0004736633272841573, 0.00041974522173404694, 0.00038188707549124956, 0.0003558993339538574, 0.0003323554992675781, 0.00030881166458129883, 0.00028526782989501953, 0.00026172399520874023, 0.00023936218349263072, 0.00022274162620306015, 0.00021388864843174815, 0.0002107769250869751, 0.00020884722471237183, 0.00020691752433776855, 0.00020498782396316528, 0.000203058123588562, 0.00020169193157926202, 0.0002030627802014351, 0.00020813668379560113, 0.00021594762802124023, 0.00022432208061218262, 0.000232696533203125, 0.00024107098579406738, 0.00024944543838500977, 0.0002554627717472613, 0.0002500312402844429, 0.0002291100681759417, 0.0001967400312423706, 0.00016201287508010864, 0.00012728571891784668, 9.255856275558472e-05, 5.7831406593322754e-05, 2.3257452994585037e-05, -1.0572373867034912e-05, -4.339544102549553e-05, -7.547438144683838e-05, -0.00010740011930465698, -0.00013932585716247559, -0.0001712515950202942, -0.0002031773328781128, -0.0002327047986909747, -0.0002505835145711899, -0.00025270215701311827, -0.0002431720495223999, -0.00023124366998672485, -0.0002193152904510498, -0.00020738691091537476, -0.0001954585313796997, -0.00019313098164275289, -0.00023743603378534317, -0.00034483225317671895, -0.0004988610744476318, -0.000662490725517273, -0.0008261203765869141, -0.0009897500276565552, -0.0011533796787261963, -0.0013024497893638909, -0.0013808021321892738, -0.001363477495033294, -0.0012754350900650024, -0.0011728331446647644, -0.0010702311992645264, -0.0009676292538642883, -0.0008650273084640503, -0.0007721749134361744, -0.0007266774773597717, -0.0007452485151588917, -0.0008111745119094849, -0.0008868500590324402, -0.0009625256061553955, -0.0010382011532783508, -0.0011138767004013062, -0.0011850576265715063, -0.0012344075366854668, -0.0012542213662527502, -0.001252204179763794, -0.0012456923723220825, -0.001239180564880371, -0.0012326687574386597, -0.0012261569499969482, -0.0012205525417812169, -0.0012193555012345314, -0.0012241213698871434, -0.0012332946062088013, -0.0012433752417564392, -0.0012534558773040771, -0.001263536512851715, -0.001273617148399353, -0.001282079378142953, -0.0012826807796955109, -0.0012726469431072474, -0.001254752278327942, -0.0012352392077445984, -0.0012157261371612549, -0.0011962130665779114, -0.0011766999959945679, -0.0011579040437936783, -0.0011425912380218506, -0.0011319909244775772, -0.0011248737573623657, -0.0011184737086296082, -0.0011120736598968506, -0.001105673611164093, -0.0010992735624313354, -0.0010943688685074449, -0.0010967273265123367, -0.0011089124018326402, -0.001128360629081726, -0.001149304211139679, -0.0011702477931976318, -0.0011911913752555847, -0.0012121349573135376, -0.0012385359732434154, 
-0.0012914445251226425, -0.0013802162138745189, -0.0014954954385757446, -0.0016162320971488953, -0.001736968755722046, -0.0018577054142951965, -0.001978442072868347, -0.0021205716766417027, -0.0023666098713874817, -0.0027532302774488926, -0.003243759274482727, -0.0037556812167167664, -0.004267603158950806, -0.004779525101184845, -0.005291447043418884, -0.005785525776445866, -0.00619293749332428, -0.006483093835413456, -0.006686583161354065, -0.006872229278087616, -0.007057875394821167, -0.007243521511554718, -0.007429167628288269, -0.007611593639012426, -0.007778379134833813, -0.00792400393402204, -0.008053988218307495, -0.008180752396583557, -0.00830751657485962, -0.008434280753135681, -0.008561044931411743, -0.00871706468751654, -0.009015182964503765, -0.009505552181508392, -0.010138019919395447, -0.010799743235111237, -0.011461466550827026, -0.012123189866542816, -0.012784913182258606, -0.013429252489004284, -0.013989155180752277, -0.014434820099268109, -0.014796048402786255, -0.01513989269733429, -0.015483736991882324, -0.01582758128643036, -0.016171425580978394, -0.01649394416017458, -0.016712880693376064, -0.01679167681140825, -0.01676689088344574, -0.016720779240131378, -0.016674667596817017, -0.016628555953502655, -0.016582444310188293, -0.016524159582331777, -0.016406748443841934, -0.016209342749789357, -0.015952810645103455, -0.015684105455875397, -0.015415400266647339, -0.015146695077419281, -0.014877989888191223, -0.01452278025681153, -0.01374740619212389, -0.0124035743647255, -0.010639578104019165, -0.008789077401161194, -0.006938576698303223, -0.0050880759954452515, -0.0032375752925872803, -0.001464882749132812, -7.011555135250092e-05, 0.0008133408846333623, 0.0013188719749450684, 0.0017465949058532715, 0.0021743178367614746, 0.0026020407676696777, 0.003029763698577881, 0.0034392697853036225, 0.003760294057428837, 0.003961607639212161, 0.0040744394063949585, 0.004169054329395294, 0.00426366925239563, 0.004358284175395966, 0.004452899098396301, 0.004541205824352801, 0.004598872736096382, 0.0046150857815518975, 0.004600659012794495, 0.004579924046993256, 0.004559189081192017, 0.004538454115390778, 0.004517719149589539, 0.004502406984101981, 0.004513434134423733, 0.004560096829663962, 0.004633098840713501, 0.004711523652076721, 0.004789948463439941, 0.004868373274803162, 0.004946798086166382, 0.005130264849867672, 0.005823935382068157, 0.007207881601061672, 0.009102031588554382, 0.011101223528385162, 0.013100415468215942, 0.015099607408046722, 0.017098799347877502, 0.019049369846470654, 0.020763779059052467, 0.022158675943501294, 0.023317411541938782, 0.02442752569913864, 0.0255376398563385, 0.02664775401353836, 0.02775786817073822, 0.028805582434870303, 0.029550211504101753, 0.029884784133173525, 0.029916271567344666, 0.02988535910844803, 0.02985444664955139, 0.029823534190654755, 0.029792621731758118, 0.02976038953056559, 0.029721747152507305, 0.02967443218221888, 0.029620707035064697, 0.029565662145614624, 0.02951061725616455, 0.029455572366714478, 0.029400527477264404, 0.02934364293469116, 0.02927782293409109, 0.029199913784395903, 0.02911306917667389, 0.029024384915828705, 0.02893570065498352, 0.028847016394138336, 0.028758332133293152, 0.028662704455200583, 0.028533351607620716, 0.028358370589558035, 0.028149664402008057, 0.027934014797210693, 0.02771836519241333, 0.027502715587615967, 0.027287065982818604, 0.027066180191468447, 0.026819861494004726, 0.026539133570622653, 0.026232972741127014, 0.025921575725078583, 0.02561017870903015, 0.02529878169298172, 0.02498738467693329, 0.024675589986145496, 0.02436186373233795, 0.024045524187386036, 0.023727253079414368, 0.02340858429670334, 0.02308991551399231, 0.02277124673128128, 0.02245257794857025, 0.022121277288533747, 0.021728621795773506, 0.021252956823445857, 0.02071593701839447, 0.02016628533601761, 0.019616633653640747, 0.019066981971263885, 0.018517330288887024, 0.017987489409279078, 0.01755387242883444, 0.01725044072372839, 0.017043232917785645, 0.016855835914611816, 0.01666843891143799, 0.01648104190826416, 0.016293644905090332, 0.01610090129543096, 0.015882188454270363, 0.015628340770490468, 0.01534852385520935, 0.015063360333442688, 0.014778196811676025, 0.014493033289909363, 0.0142078697681427, 0.013931441237218678, 0.013697439804673195, 0.013520839740522206, 0.013386666774749756, 0.013261228799819946, 0.013135790824890137, 0.013010352849960327, 0.012884914875030518, 0.012763276405166835, 0.012660092674195766, 0.01258187711937353, 0.012522116303443909, 0.012466154992580414, 0.012410193681716919, 0.012354232370853424, 0.01229827105998993, 0.01224423700477928, 0.012199563905596733, 0.01216755562927574, 0.012144908308982849, 0.012124188244342804, 0.012103468179702759, 0.012082748115062714, 0.012062028050422668, 0.01204134791623801, 0.012020861729979515, 0.012000637943856418, 0.011980608105659485, 0.011960618197917938, 0.011940628290176392, 0.011920638382434845, 0.011900648474693298, 0.01188081462169066, 0.011861738748848438, 0.01184368837857619, 0.011826395988464355, 0.01180925965309143, 0.011792123317718506, 0.011774986982345581, 0.011757850646972656, 0.011741316528059542, 0.011727707460522652, 0.011718055815435946, 0.011711329221725464, 0.011705204844474792, 0.011699080467224121, 0.01169295608997345, 0.011686831712722778, 0.011680714262183756, 0.011674630455672741, 0.01166859216755256, 0.011662587523460388, 0.011656589806079865, 0.01165059208869934, 0.011644594371318817, 0.011638596653938293, 0.011631115805357695, 0.011616431176662445, 0.011592000257223845, 0.011560365557670593, 0.011527247726917267, 0.01149412989616394, 0.011461012065410614, 0.011427894234657288, 0.0113963732146658, 0.011372608132660389, 0.011359336378518492, 0.011353820562362671, 0.011349901556968689, 0.011345982551574707, 0.011342063546180725, 0.011338144540786743, 0.01133331039454788, 0.01132403127849102, 0.011308738379739225, 0.011289000511169434, 0.01126834750175476, 0.011247694492340088, 0.011227041482925415, 0.011206388473510742, 0.011185044830199331, 0.011160346679389477, 0.0111311100772582, 0.011098518967628479, 0.01106523722410202, 0.011031955480575562, 0.010998673737049103, 0.010965391993522644, 0.010932829813100398, 0.01090376265347004, 0.010879424051381648, 0.010858580470085144, 0.010838456451892853, 0.010818332433700562, 0.01079820841550827, 0.010778084397315979, 0.01075653062434867, 0.01072803232818842, 0.010690138500649482, 0.010645300149917603, 0.010599032044410706, 0.010552763938903809, 0.010506495833396912, 0.010460227727890015, 0.010414397227577865, 0.010370692238211632, 0.010329862940125167, 0.01029115915298462, 0.010252892971038818, 0.010214626789093018, 0.010176360607147217, 0.010138094425201416, 0.010202704987023026, 0.01076700259000063, 0.01200734736630693, 0.013747379183769226, 0.015590287744998932, 0.017433196306228638, 0.019276104867458344, 0.02111901342868805, 0.024868885637260973, 0.0378811527043581, 0.06342489516828209, 0.09823103249073029, 0.1349441334605217, 0.1716572344303131, 0.20837033540010452, 0.24508343636989594, 0.2830550173530355, 0.32713921554386616, 0.37949342525098473, 0.4379602521657944, 0.4976855590939522, 0.55741086602211, 0.6171361729502678, 0.6768614798784256, 0.7290756379370578, 0.7448070729151368, 0.7111795296077617, 0.6410692632198334, 0.5634478479623795, 0.48582643270492554, 0.4082050174474716, 0.3305836021900177, 0.25610611744923517, 0.19689915236085653, 0.15835230209631845, 0.13507597148418427, 0.11494357138872147, 0.09481117129325867, 0.07467877119779587, 0.05454637110233307, 0.03554170607822016, 0.022014611400663853, 0.015898347191978246, 0.015259653329849243, 0.01574869453907013, 0.016237735748291016, 0.016726776957511902, 0.017215818166732788, 0.017617604811675847, 0.017595583572983742, 0.01700017519760877, 0.015980958938598633, 0.014874488115310669, 0.013768017292022705, 0.012661546468734741, 0.011555075645446777, 0.010487901279702783, 0.009611595422029495, 0.008993523428216577, 0.008566319942474365, 0.008178412914276123, 0.007790505886077881, 0.007402598857879639, 0.0070146918296813965, 0.00664555822731927, 0.006367609836161137, 0.006213029671926051, 0.0061496347188949585, 0.006105013191699982, 0.006060391664505005, 0.006015770137310028, 0.005971148610115051, 0.005924735916778445, 0.005869623273611069, 0.0058027401100844145, 0.00572715699672699, 0.005649782717227936, 0.005572408437728882, 0.005495034158229828, 0.005417659878730774, 0.005343847558833659, 0.0052873361855745316, 0.005254231975413859, 0.005238428711891174, 0.0052261874079704285, 0.005213946104049683, 0.005201704800128937, 0.005189463496208191, 0.005169004260096699, 0.0051086293533444405, 0.004994250892195851, 0.004839956760406494, 0.004677444696426392, 0.004514932632446289, 0.0043524205684661865, 0.004189908504486084, 0.00403709668898955, 0.003931400366127491, 0.0038894485333003104, 0.003894612193107605, 0.003909476101398468, 0.003924340009689331, 0.003939203917980194, 0.003954067826271057, 0.003935541724786162, 0.0037548355758190155, 0.0033547093626111746, 0.0027924031019210815, 0.0021967068314552307, 0.0016010105609893799, 0.001005314290523529, 0.0004096180200576782, -0.00014471111353486776, -0.0004981141537427902, -0.0005796760087832808, -0.00046031177043914795, -0.0002995803952217102, -0.00013884902000427246, 2.1882355213165283e-05, 0.00018261373043060303, 0.0003239295328967273, 0.000370941124856472, 0.0002903646673075855, 0.00011548399925231934, -7.881224155426025e-05, -0.00027310848236083984, -0.00046740472316741943, -0.000661700963973999, -0.0008417338831350207, -0.0009524878114461899, -0.0009695113403722644, -0.0009172558784484863, -0.0008507370948791504, -0.0007842183113098145, -0.0007176995277404785, -0.0006511807441711426, -0.000587238697335124, -0.0005358122289180756, -0.0005013186018913984, -0.0004793405532836914, -0.00045993924140930176, -0.0004405379295349121, -0.00042113661766052246, -0.0004017353057861328, -0.0003836952964775264, -0.00037226732820272446, -0.00036978506250306964, -0.00037391483783721924, -0.0003794059157371521, 
-0.00038489699363708496, -0.0003903880715370178, -0.0003958791494369507, -0.0004014309379272163, -0.0004072776064276695, -0.00041352323023602366, -0.00042006373405456543, -0.00042666494846343994, -0.00043326616287231445, -0.00043986737728118896, -0.0004464685916900635, -0.000451587897259742, -0.000449509359896183, -0.0004376925644464791, -0.0004186779260635376, -0.00039818137884140015, -0.0003776848316192627, -0.00035718828439712524, -0.0003366917371749878, -0.00031792320078238845, -0.0003075478598475456, -0.0003085280186496675, -0.0003179013729095459, -0.0003290027379989624, -0.0003401041030883789, -0.0003512054681777954, -0.0003623068332672119, -0.0003724119742400944, -0.0003776783123612404, -0.00037639803485944867, -0.0003702789545059204, -0.00036316365003585815, -0.0003560483455657959, -0.00034893304109573364, -0.0003418177366256714, -0.0003353022038936615, -0.00033169984817504883, -0.00033203884959220886, -0.0003352910280227661, -0.00033914297819137573, -0.00034299492835998535, -0.00034684687852859497, -0.0003506988286972046, -0.0003552638227120042, -0.0003632921725511551, -0.0003760062390938401, -0.00039218366146087646, -0.0004090741276741028, -0.0004259645938873291, -0.0004428550601005554, -0.00045974552631378174, -0.00047158641973510385, -0.0004589008167386055, -0.0004130323068238795, -0.000342637300491333, -0.0002671927213668823, -0.00019174814224243164, -0.00011630356311798096, -4.0858983993530273e-05, 2.6687514036893845e-05, 5.587190389633179e-05, 3.315461799502373e-05, -2.7924776077270508e-05, -9.690225124359131e-05, -0.0001658797264099121, -0.0002348572015762329, -0.0003038346767425537, -0.000363927218131721, -0.00038086436688899994, -0.0003394148079678416, -0.0002548098564147949, -0.00016131997108459473, -6.783008575439453e-05, 2.5659799575805664e-05, 0.00011914968490600586, 0.00020857725758105516, 0.0002782735973596573, 0.000321274739690125, 0.0003445446491241455, 0.00036375224590301514, 0.00038295984268188477, 0.0004021674394607544, 0.000421375036239624, 0.00043529673712328076, 0.0004235440865159035, 0.0003770555485971272, 0.0003048926591873169, 0.0002274438738822937, 
0.0001499950885772705, 7.254630327224731e-05, -4.902482032775879e-06, -7.896288298070431e-05, -0.0001365654170513153, -0.00017190142534673214, -0.00019077956676483154, -0.00020626932382583618, -0.00022175908088684082, -0.00023724883794784546, -0.0002527385950088501, -0.0002663960331119597, -0.00027115363627672195, -0.0002638702862896025, -0.00024768710136413574, -0.00022967159748077393, -0.0002116560935974121, -0.0001936405897140503, -0.00017562508583068848, -0.0001611560583114624, -0.00016391277313232422, -0.00018997490406036377, -0.0002332627773284912, -0.0002800971269607544, -0.0003269314765930176, -0.00037376582622528076, -0.00042060017585754395, -0.0004642987623810768, -0.0004927664995193481, -0.0005006277933716774, -0.0004932582378387451, -0.0004827529191970825, -0.0004722476005554199, -0.0004617422819137573, -0.0004512369632720947, -0.00043996074236929417, -0.0004249401390552521, -0.0004048536065965891, -0.00038102269172668457, -0.0003564208745956421, -0.0003318190574645996, -0.00030721724033355713, -0.00028261542320251465, -0.0002569367061369121, -0.00022602733224630356, -0.00018804118735715747, -0.00014482438564300537, -0.00010053068399429321, -5.6236982345581055e-05, -1.1943280696868896e-05, 3.235042095184326e-05, 7.53936474211514e-05, 0.00011236313730478287, 0.0001411152188666165, 0.00016379356384277344, 0.00018522143363952637, 0.0002066493034362793, 0.00022807717323303223, 0.00024950504302978516, 0.0002694795257411897, 0.0002823946997523308, 0.0002857590443454683, 0.0002820640802383423, 0.0002769157290458679, 0.00027176737785339355, 0.0002666190266609192, 0.0002614706754684448, 0.0002497248351573944, 0.0002059340476989746, 0.00011878833174705505, -4.023313522338867e-07, -0.00012619048357009888, -0.00025197863578796387, -0.00037776678800582886, -0.0005035549402236938, -0.0006254951003938913, -0.0007287450134754181, -0.0008067081216722727, -0.0008659809827804565, -0.0009214058518409729, -0.0009768307209014893, -0.0010322555899620056, -0.001087680459022522, -0.0011392300366424024, -0.0011719567701220512, -0.0011792173027060926, -0.0011676549911499023, -0.0011522173881530762, 
-0.00113677978515625, -0.0011213421821594238, -0.0011059045791625977, -0.001085553492885083, -0.0010413369163870811, -0.0009648317354731262, -0.0008644610643386841, -0.0007591769099235535, -0.0006538927555084229, -0.0005486086010932922, -0.0004433244466781616, -0.00033631635596975684, -0.00022093486040830612, -9.42246406339109e-05, 4.0858983993530273e-05, 0.0001776665449142456, 0.00031447410583496094, 0.00045128166675567627, 0.0005880892276763916, 0.0007049058913253248, 0.0007246239110827446, 0.0006129731773398817, 0.00040422379970550537, 0.00017548352479934692, -5.3256750106811523e-05, -0.00028199702501296997, -0.0005107372999191284, -0.0007270441274158657, -0.0008829599246382713, -0.0009571702103130519, -0.000970989465713501, -0.0009723752737045288, -0.0009737610816955566, -0.0009751468896865845, -0.0009765326976776123, -0.000978470197878778, -0.000983087345957756, -0.0009913298999890685, -0.0010022521018981934, -0.001013725996017456, -0.0010251998901367188, -0.0010366737842559814, -0.0010481476783752441, -0.0010578405926935375, -0.0010588830336928368, -0.0010482218931429088, -0.0010289102792739868, -0.0010078176856040955, -0.000986725091934204, -0.0009656324982643127, -0.0009445399045944214, -0.0009246301488019526, -0.0009104656055569649, -0.0009040739969350398, -0.0009034276008605957, -0.0009039640426635742, -0.0009045004844665527, -0.0009050369262695312, -0.0009055733680725098, -0.0009068798972293735, -0.0009119268506765366, -0.0009220343781635165, -0.0009358823299407959, -0.0009505003690719604, -0.000965118408203125, -0.0009797364473342896, -0.000994354486465454, -0.0010094622848555446, -0.0010269489139318466, -0.0010476539609953761, -0.0010707378387451172, -0.0010943114757537842, -0.0011178851127624512, -0.0011414587497711182, -0.0011650323867797852, -0.0011899950332008302, -0.0012217042967677116, -0.0012625413364730775, -0.0013101249933242798, -0.00135909765958786, -0.0014080703258514404, -0.0014570429921150208, -0.001506015658378601, -0.001554439077153802, -0.0016001947224140167, -0.0016423410270363092, -0.0016818195581436157, -0.0017207488417625427, -0.0017596781253814697, -0.0017986074090003967, -0.0018375366926193237, -0.001872297318186611, -0.0018868101760745049, -0.0018739289953373373, -0.0018408000469207764, -0.0018035024404525757, -0.001766204833984375, -0.0017289072275161743, -0.0016916096210479736, -0.0016553616151213646, -0.0016242116689682007, -0.001599959097802639, -0.0015808045864105225, -0.0015626996755599976, -0.0015445947647094727, -0.0015264898538589478, -0.0015083849430084229, -0.0014835713081993163, -0.0014261724427342415, -0.0013246876769699156, -0.0011906176805496216, -0.0010498389601707458, -0.0009090602397918701, -0.0007682815194129944, -0.0006275027990341187, -0.0004972587921656668, -0.0004181833937764168, -0.00040833611274138093, -0.0004496574401855469, -0.0005015134811401367, -0.0005533695220947266, -0.0006052255630493164, -0.0006570816040039062, -0.0007052840082906187, -0.000735740177333355, -0.0007421867339871824, -0.0007308870553970337, -0.0007159337401390076, -0.0007009804248809814, -0.0006860271096229553, -0.0006710737943649292, -0.0006535290740430355, -0.0006233975291252136, -0.0005762367509305477, -0.0005164891481399536, -0.00045415014028549194, -0.0003918111324310303, -0.0003294721245765686, -0.00026713311672210693, -0.000185313168913126, -0.0001424551010131836]

# Define path to database for pyodrivecan package.
database = pyodrivecan.OdriveDatabase('odrive_data.db')


def get_raw_position_over_time(trial_id, node_id):
    """
    Fetches raw position and time data for a given trial_id and node_id from the database.

    Parameters:
    - trial_id (int): The trial ID to filter the data.
    - node_id (int): The node ID to filter the data.

    Returns:
    - tuple: (times, positions, trial_id, node_id) where times and positions are lists of recorded data.
             Returns None for times and positions if no data is found.
    """
    # SQL query to select time and position for a specific trial_id and node_id
    sql = """
    SELECT time, position FROM ODriveData
    WHERE trial_id = ? AND node_ID = ?
    ORDER BY time;
    """
    # Execute the query and fetch all results
    results = database.fetch(sql, (trial_id, node_id))
    
    # If results are empty, inform the user and return None
    if not results:
        print("No data found for the given trial_id and node_id.")
        return

    # Unpack the results into separate lists
    times, positions = zip(*results)
    return times, positions, trial_id, node_id

async def smooth_send_positions_to_motor(odrive1, odrive2):
     dt = 0.01
     #Run for set time delay example runs for 15 seconds.
     #stop_at = datetime.now() + timedelta(seconds=30)
     #while datetime.now() < stop_at:
     for pos1, pos2 in zip(nodeID_1_pos, nodeID_2_pos):
        odrive1.set_position(pos1)
        odrive2.set_position(pos2)
        print(f"Setting motor position to: {pos1}")
        print(f"Setting motor position to: {pos2}")
         
        await asyncio.sleep(dt)


# Function to send positions to the motor
async def send_positions_to_motor(odrive1, positions):
    """
    Sends the position commands to the motor to repeat the path.
    Parameters:
    - recorded_positions (list): The recorded positions to be used as via points.
    - total_time (float): The total time for the trajectory.
    - tacc (float): Acceleration time for the trajectory.
    - qdmax (float): Maximum speed for the trajectory.
    """
    
    #Run for set time delay example runs for 15 seconds.
    stop_at = datetime.now() + timedelta(seconds=30)
    while datetime.now() < stop_at:
        dt = 0.15
        # Iterate over the positions and send them to the motor
        for pos in positions.flatten():
            #odrive1.set_position(pos)
            print(f"Setting motor position to: {pos}") 
            await asyncio.sleep(dt)

    odrive1.running = False
    


#Example of how you can create a controller to get data from the O-Drives and then send motor comands based on that data.
async def controller(odrive1, odrive2, odrive3):
        #odrive1.set_position(0)
        #print("Set odrive to postion 0")
        #odrive2.set_position(0)
        #odrive3.set_position(0)
        # Example usage
        #recorded_times, recorded_positions, _, _ = get_raw_position_over_time(10, 1)
        
        dt = 0.125


        #Run for set time delay example runs for 15 seconds.
        stop_at = datetime.now() + timedelta(seconds=15)
        while datetime.now() < stop_at:
            await asyncio.sleep(0) #Need this for async to work.
            #print(odrive1.position, odrive2.position)
            #for pos in recorded_positions:
                #odrive1.set_position(pos)
                #await asyncio.sleep(dt)
            #print("Set odrive to postion 0")
            #await asyncio.sleep(3)
            #odrive1.set_position(3)
            #print("Set odrive to postion 3")
            #await asyncio.sleep(3)
            
    
            

        #await asyncio.sleep(15) #no longer need this the timedelta =15 runs the program for 15 seconds.
        odrive1.running = False
        odrive2.running = False
        odrive3.running = False



# Run multiple busses.
async def main():
    #Set up Node_ID 1
    odrive1 = pyodrivecan.ODriveCAN(1, closed_loop_control_flag = True)
    odrive1.initCanBus()

    #Set up Node_ID 2 
    odrive2 = pyodrivecan.ODriveCAN(2, closed_loop_control_flag = True)
    odrive2.initCanBus()

    #Set up Node_ID 3 
    odrive3 = pyodrivecan.ODriveCAN(3, closed_loop_control_flag = True)
    odrive3.initCanBus()

    # Example usage
    #recorded_times, recorded_positions, _, _ = get_raw_position_over_time(10, 1)
    #total_time = 10  # Total time to complete the path in seconds

    
    #add each odrive to the async loop so they will run.
    await asyncio.gather(
        odrive1.loop(),
        odrive2.loop(),
        odrive3.loop(),
        #controller(odrive1, odrive2, odrive3),
        smooth_send_positions_to_motor(odrive1, odrive2)
        #send_positions_to_motor(odrive1, positions)
    )

if __name__ == "__main__":
    asyncio.run(main())